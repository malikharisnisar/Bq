<!doctype html>
<html lang="en">
    <head>
        <title>Update Post - BlogPost Site</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="Update your blog post on our site.">
        <link rel="stylesheet" href="updatepost.css" >
    </head>
    <body>
        <!-- Removed placeholder <h1>working</h1> as it seemed erroneous; integrated into main header if needed -->
        <header class="main-header">
            <h1>Update Post</h1> <!-- Consolidated title for clarity -->
        </header>

        <nav>
            <ul>
                <li><a href="/">Home</a></li>
                <li><a href="/dashboard">Dashboard</a></li> <!-- Fixed capitalization for consistency -->
                <li><a href="/logout">Logout</a></li>
            </ul>
        </nav>

        <main id="list">
            <form action="" method="post">
                <div>
                    <label for="post-title">Title:</label>
                    <input id="post-title" type="text" name="title" required>
                </div>
                <div>
                    <label for="post-content">Content:</label>
                    <textarea id="post-content" name="content" required></textarea> <!-- Changed to textarea for better content editing -->
                </div>
                <input type="hidden" name="_method" value="put">
                <button type="submit">Save Update</button> <!-- Fixed typo: "submlit" to "submit" -->
            </form>
        </main>

        <script>
            // Improved script with error handling for cookie parsing
            let cookie = document.cookie;
            if (cookie) {
                let parts = cookie.split('=');
                if (parts.length >= 2) {
                    let objStr = parts.slice(1).join('='); // Handle if cookie has more parts
                    try {
                        let obj = JSON.parse(decodeURIComponent(objStr)); // Decode if needed
                        
                        let titleInput = document.getElementById('post-title');
                        if (titleInput && obj.title) {
                            titleInput.value = obj.title;
                        }
                        
                        let contentInput = document.getElementById('post-content');
                        if (contentInput && obj.content) {
                            contentInput.value = obj.content;
                        }
                        
                        let form = document.querySelector('form');
                        if (form && obj.id) {
                            form.action = `http://localhost:3000/post/${obj.id}?_method=put`;
                        }
                    } catch (e) {
                        console.error('Error parsing cookie:', e); // Fallback for errors
                    }
                }
            }
        </script>
        <!-- Commented script from original ignored; this is the integrated version -->
    </body>
</html>